<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Coach2mqtt Installation Guide</title>
    <meta name="description" content="Instructions for assembling and setting up coach2mqtt on a Raspberry Pi">
    <meta name="author" content="Dan Berglund">

    <link rel="stylesheet" href="style.css?">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;700&family=Open+Sans:ital,wght@0,400;0,700;1,600&display=swap" rel="stylesheet">
    
    <script defer src="https://use.fontawesome.com/releases/v5.7.2/js/all.js" integrity="sha384-0pzryjIRos8mFBWMzSSZApWtPl/5++eIfzYmTgBBmXYdhvxPc+XcFEk+zJwDgWbP" crossorigin="anonymous"></script>

</head>

<body>

    <div class="navbar clear nav-top">
        <div class="row content">
            <a href="#"><img class="logo" src="logo.svg"></a>
            <!-- <a class="right" style="text-decoration: underline;" href="#"><i class="fas fa-book"></i>&nbsp;Documentation</a> -->
            <!-- <a class="right" href="mailto:yourapp@email.com" target="_blank"><i class="fas fa-paper-plane"></i>&nbsp; yourapp@email.com</a> -->
        </div>
    </div>

    <div class="container clear">
        <div class="row wrapper">

            <div class="sidepanel">

                <a class="title" href="#">Introduction</a>
                
                <div class="divider left"></div>

                <a class="title" href="#gettingstarted">Getting Started</a>

                <a class="section" href="#assemblehardware">The Hardware</a>
                <a class="section" href="#installingimage">Installing the Image</a>
                <a class="section" href="#installingapp">Installing the App</a>
                <a class="section" href="#remoteaccesssetup">Setting up remote access</a>

                <div class="divider left"></div>

                <a class="title" href="#basicfeatures">Basic Features</a>

                <a class="section" href="#basicfeatures">Feature 1</a>
                <a class="section" href="#basicfeatures">Feature 2</a>
                <a class="section" href="#feature3">Feature 3</a>

                <div class="divider left"></div>

                <a class="title" href="#advanced">Advanced Features</a>

                <a class="section" href="#advanced">Feature A</a>
                <a class="section" href="#featureb">Feature B</a>
                <a class="section" href="#featurec">Feature C</a>
                <a class="sub-section" href="#featurec1">Feature C.1</a>
                <a class="sub-section" href="#featurec2">Feature C.2</a>

                <div class="divider left"></div>


                <a class="title" href="#moreinfo">More Info</a>
            
             <div class="space double"></div>

            </div>

            <div class="right-col">
            


                <h1 >Introduction</h1>
                
                <p>Coach2mqtt runs on a <a href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/">RaspberryPi 4B</a> and allows you to control and monitor most of the systems in your Jayco Swift/Entegra Ethos or your Jayco Terrain/Entegra Launch from your phone or tablet while connected to the same wifi network as the Raspberry Pi. 
                </p>
                <p>Optionally, if your wifi network is also connected to the internet, you will be able to monitor and control your devices from anywhere your phone or tablet has internet.
                </p>
                <p>On Renogy Lithium battery models you will be able to control most of the firefly devices, monitor the Renogy battery BMS, and monitor and control your Renogy Inverter/Charger.
                </p> 
                <p>On generator models you will be able to control and monitor most of the firefly devices.
                </p>
                <p>Lithionics models have not been tested.
                </p>

                <p id="gettingstarted"></p>
                 
        <div class="divider" style="width:24%; margin:30px 0;"></div>

                <p id="assemblehardware"></p>
                <h1>Getting Started</h1>

                <h2>Hardware requirements</h2>

                <p>All links are just to help you find the products and are not an endorsement of the product or retailer.</p>

                You will need the following:
                <ul>
                    <li>
                        <a href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/">RaspberryPi 4B with at least 2GB RAM</a>
                    </li>
                    <li>
                        8GB or larger microSD card and some way to write to it.
                        <br>I recommend A2 speed rating.
                        <ul>
                            <li><a href="https://www.pishop.us/product/raspberry-pi-sd-card-32gb/?src=raspberrypi">Official Raspberry Pi microSD Card microsd card</a></li>
                            <li><a href="https://www.bestbuy.com/site/sandisk-extreme-plus-64gb-microsdxc-uhs-i-memory-card/6495764.p?skuId=6495764">64GB Sandisk Extreme Plus</a></li>
                        </ul>

                    </li>
                    <li>
                        <a href="https://www.waveshare.com/2-ch-can-hat-plus.htm">Waveshare 2-Channel CAN Hat+</a>
                        <ul>
                            <li>
                                <a href="https://www.amazon.com/Waveshare-2-Channel-Expansion-Compatible-Protections/dp/B0D3GD458Z">Amazon</a>
                            </li>
                        </ul>
                        <b>Important:</b> Be sure to buy the + version so you can power the Pi and Hat from the RV-C cable.
                        <img src="images/canhatplus.png" alt="Can HAT+" class="screenshot" style="width: 40%; height: 40%" />
                    </li>
                    <br>
                    <li>
                        A case for RaspberryPi 4B that can accomodate the CAN bus hat
                        <ul>
                            <li><a href="https://www.amazon.com/HighPi-Raspberry-Pi-Case/dp/B0BWC714GY">Black HighPi Raspberry Pi Case for Pi 4 from Amazon</a></li>
                            <li><a href="https://www.pishop.us/product/highpi-raspberry-pi-case-for-pi4/">Black HighPi Raspberry Pi Case for Pi 4i from PiShop</a></li>
                            <li><a href="https://www.pishop.us/product/highpi-raspberry-pi-case-for-pi4-white/">White HighPi Raspberry Pi Case for Pi 4 from PiShop</a></li>
                            <li><a href="https://www.pishop.us/product/highpi-raspberry-pi-case-for-pi4-clear/">Clear HighPi Raspberry Pi Case for Pi 4 from PiShop</a></li>
                        </ul>
                    </li>
                    <br>
                    <li>
                        Several feet of RV-C drop cable (4 conductor 24awg) or equivalant. Get enough so you have some flexibility where you mount the Raspberry Pi but I recommend you keep the length as short as possible to reduce voltage loss. Any 4 conductor wire will probably work for this project.
                        <ul>
                            <li>
                                <a href="https://www.fireflyint.com/products/70053-24ga-rv-c-drop-cable">RV-C drop cable from FireFly integrations</a>
                            </li>
                            <li>
                                <a href="https://www.fireflyint.com/products/70079a-10-ft-plugplug-drop-cable-assembly">10ft with plugs attached already</a>
                            </li>
                            <li>
                                <a href="https://www.fireflyint.com/products/70077a-6-ft-plugplug-drop-cable-assembly">6ft with plugs attached already</a>
                            </li>
                        </ul>
                    </li>
                    <br>
                    <li>
                         One 3M miniplug connector to connect RV-C bus. Alternatively you can buy RV-C cable with a plug already attached (see above)
                        <ul>
                            <li>
                                <a href="https://www.fireflyint.com/products/70090-3m-mini-plug-connector">From Firefly Integrations</a>
                            </li>
                            <li>
                                <a href="https://www.digikey.com/en/products/detail/3m/37104-A165-00E%2520MB/1855697">From Digikey</a>
                            </li>
                            <br>
                            As an alternative, or if you have no 3M miniplug ports available, you can connect to the G12 4 pin molex service port. You will need this style connector
                            <li>
                                <a href="https://www.amazon.com/dp/B0753VW1B4">Molex Connector from Amazon</a>
                            </li>
                        </ul>
                    </li>
                    <h3>Renogy Lithium models also require:</h3>
                    <ul>
                        <li>
                            High quality USB 2.0 A to B cable to connect to Renogy Inverter. I recommend you get a cable with ferrite cores attached to reduce possible noise on the USB bus. Be sure to get one that is long enough to reach from the inverter to the where you are mounting the Pi.
                            <ul>
                                <li>
                                    <a href="https://www.amazon.com/Tripp-Lite-Hi-Speed-Ferrite-U023-006/dp/B008VOPCGY">Example from Amazon</a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            In some cases the inverter seems to create enough interference that the USB connection to the inverter is unstable. I recommend you try the USB cable first, but as an alternative you may need to use a USB to RS485 adapter.
                            <ul>
                                <li>
                                    <a href="https://www.waveshare.com/product/iot-communication/wired-comm-converter/rs232-rs485-can-dali2/usb-to-rs485.htm">Waveshare USB to RS485</a>
                                </li>
                            </ul>
                                <li>
                                    <a href="https://www.waveshare.com/usb-to-rs485-422.htm">Industrial isolated Waveshare USB to RS485</a>
                                </li>
                        </li>
                        <li>
                            Connector for Renogy BMS Debug port
                            <ul>
                                <li>
                                    <a href="https://www.amazon.com/dp/B0BX42NJWR">2 pin connector on Amazon</a>
                                </li>
                            </ul>
                    </ul>


                <h2>Assembling the hardware</h2>

                <p>Attach the waveshare </p>
                <ol>
                    <li>
                        Attach the Waveshare Can HAT+ to the Pi
                        <br>Be sure the resistor jumpers next to the CAN terminal blocks are in the off position and the voltage jumper is set to 3v3 (as pictured)
                        <br><br>
                        <ul>
                            <lii style="list-style-type: none;">
                            <img src="images/canhat1.jpg" alt="Can HAT+" class="screenshot" style="width: 50%; height: 50%" />
                            <img src="images/canhat2.jpg" alt="Install stand-offs" class="screenshot" style="width: 50%; height: 50%" />
                            <img src="images/canhat3.jpg" alt="Attach Can HAT+" class="screenshot" style="width: 50%; height: 50%" />
                            </li>
                        </ul>
                    </li>
                    <li>
                        If the case you are using allows access to the microsd card you can install the Pi in the case now
                    </li>
                </ol>
                <p id="installingimage">

                <h2>Installing Coach2mqtt</h2>

                <p>To use Coach2mqtt you will need to install an image on the Rasperry Pi and an app on your phone or tablet.</p>

                <h3>Install the image</h3>
                   <ol>
                    <li>
                        <a href="https://www.raspberrypi.com/software/">Download and install the latest Raspberry Pi Imager tool</a>
                    </li>
                    <br>
                    <li>
                        <a href="https://github.com/dbergl/coach2mqtt/releases/latest">Download the latest Coach2mqtt image for the Raspberry Pi</a>. The file you should download is named 'Eth-OS-bookworm-arm64-lite.zip'. There is no need to download the Source code.
                        <p><b>Note:</b> There is no need to decompress the downloaded image. The Imager tool can install a .zip image.
                    </li>
                    <li>
                        Using the Imager tool to install the image you downloaded onto the micro SD card
                        <ol style="list-style-type: lower-alpha;">
                            <li>
                                Click <b>CHOOSE OS</b>
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images/choose_os.png" alt="Choose OS" class="screenshot" style="width: 50%; height: 50%" />
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li> Click <b>Use custom</b> and select the image you downloaded
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images/use_custom.png" alt="Use custom" class="screenshot" style="width: 50%; height: 50%" />
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                Click <b>CHOOSE STORAGE</b> and choose the card you will write the image to
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\choose_storage.png" alt="Choose Storage" class="screenshot" style="width: 50%; height: 50%" />
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                Click <b>NEXT</b> and then <b>EDIT SETTINGS</b> at the OS customisations prompt
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\OS_customization1.png" alt="OS Customizations Prompt" class="screenshot" style="width: 50%; height: 50%" />
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                Make your changes in the OS customisation dialog and then click <b>SAVE</b>:
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\OS_customization2.png" alt="OS Customizations Prompt" class="screenshot" style="width: 50%; height: 50%" />
                                    </li>
                                </ul>
                                <ul>
                                    <li>
                                        <b>Hostname</b>: Set this to any name you want. This is name you will use to access the services on your raspberry Pi
                                    </li>
                                    <li>
                                        <b>Username and Password</b>: Set a username and a <i>strong</i> password. You will use this for additional setup later.
                                    </li>
                                    <li>
                                        <b>Configure wireless LAN</b>: This will be the default wifi your Pi will connect to when powered up. I recommend setting this to either your Winegard or Starlink wifi
                                    </li>
                                    <li>
                                        <b>wireless LAN country</b>: Set this to <b>US</b> unless you are in another country
                                    </li>
                                    <li>
                                        <b>Time zone</b>: Choose an appropriate time zone
                                    </li>
                                    <li>
                                        <b>Keyboard layout</b>: select <b>us</b> unless you prefer another layout
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                Click <b>Yes</b> to use your customized settings
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\OS_customization3.png" alt="OS Customizations Prompt" class="screenshot" style="width: 50%; height: 50%" />
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                Click <b>Yes</b> to start writing to the microsd card
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\confirm.png" alt="Confirmation Dialog" class="screenshot" style="width: 50%; height: 50%" />
                                    </li>
                                </ul>
                            </li>
                        </ol>
                    </li>
                    <li>
                     After the image has been written to the card insert into the Raspberry Pi.
                    </li>
                    <br>
                </ol>
                <h3>Powering up with the new image for the first time</h3>

                <p>The first time the Raspberry Pi is powered on it may take 5 or more minutes to get everything setup.
                On first power up the Pi needs to expand the image to use the full space on the microsd card and configure your customizations. It will reboot and then will attempt to connect to the internet and download about 1 GB of files required for coach2mqtt to run.
                I recommend plugging in an ethernet cable, if possible, for the initial startup.
                <p><b>Note</b>:If your connection is too slow the download on startup may timeout and fail. You will be able to run the commands manually later if needed.

                <h3>Connecting to the Pi</h3>
                Once your device has powered on and you have waited for 5 or more minutes you can connect to the Web UI on the Pi. This is easier on a computer but a phone or tablet can be used.
                <ol>
                    <li>
                        Open a web browser and navigate to <a href="https://coach2mqtt:9090">https://coach2mqtt:9090</a> - <i>R eplace coach2mqtt with the hostname you set when creating the image</i>. <b>Depending on your network you may need to add <i>.local</i> to the hostname (i.e. coach2mqtt.local) in order to connect.</b><p>You will get a warning that the certificate is not valid or your connection is not private. This is expected and you can follow the browser instructions to connect anyway.

                    </li>
                    <li>
                        At the login dialog enter the username and password you set during image creation.
                           <br><br>
                           <ul>
                               <li style="list-style-type: none;">
                                   <img src="images\login.png" alt="Login Dialog" class="screenshot" style="width: 50%; height: 50%" />
                               </li>
                           </ul>
                    </li>
                    <li>
                        If the text shows 🔒<b>Limited Access</b> in the upper right corner click it to enable Administrative access
                           <br><br>
                           <ul>
                               <li style="list-style-type: none;">
                                   <img src="images\limited.png" alt="Login Dialog" class="screenshot" style="width: 50%; height: 50%" />
                               </li>
                               <li style="list-style-type: none;">
                                   <img src="images\administrative.png" alt="Login Dialog" class="screenshot" style="width: 50%; height: 50%" />
                               </li>
                           </ul>
                    </li>
                    <h3>Verify coach2mqtt components are running</h3>
                    <li>
                        To verify everything installed correctly we need to run some commands on the Raspberry Pi. The Web UI makes it easy to do this.
                        <p>
                        Click <b>Terminal</b> on the left side under Tools
                        <ul>
                            <li style="list-style-type: none;">
                                <img src="images\terminal.png" alt="Terminal" class="screenshot" style="width: 40%; height: 40%" />
                            </li>
                        </ul>
                    </li>
                        In the terminal area that opens type <b>c2mstatus</b> and hit &lt;enter&gt;.
                        The command will output all names of the running components.
                        <br><br>
                        <ul>
                            <li style="list-style-type: none;">
                                <img src="images\c2mstatus.png" alt="c2mstatus command" class="screenshot" style="width: 60%; height: 60%" />
                            </li>
                            You should see the 5 components as pictured.
                            <p>If any are missing you will need to run one more command to download and start them:
                            <ol style="list-style-type:lower-alpha">
                                <li>
                                    In the terminal area that opens type <b>c2mupdate</b> and hit &lt;enter&gt;.

                                    This will stop any running components, download any missing components, and then start them back up.
                                    <br><br>
                                    <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\c2mupdate2.png" alt="c2mupdate command" class="screenshot" style="width: 80%; height: 80%" />
                                    </li>
                                    </ul>
                                </li>
                            </ol>
                        </ul>
                    </li>
                    <br>
                    <li>
                        If you originally set up on your home network now is a good time to add any additional WiFi connections your Raspberry Pi may connect to such as your Winegard or Starlink.
                        <br><br>
                        <ol style="list-style-type:lower-alpha">
                            <li>
                                Click on <b>Wifi Manager</b> in the left menu
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\wifimanager.png" alt="Wifi manager" class="screenshot" style="width: 60%; height: 60%" />
                                    </li>
                                </ul>
                            </li>
                            <li>
                                Add your coach  Wifi network
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\configurenetwork.png" alt="Configure network" class="screenshot" style="width: 60%; height: 60%" />
                                    </li>
                                </ul>
                            </li>
                        </ol>
                    </li>
                    <li>
                        Once you have verified the software is running and have added your coach wifi you can safely shutdown the Pi so you can install it in your coach.
                        <br><br>
                        <ol>
                            <li>
                                Click on <b>Overview</b> in the left menu
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\overview.png" alt="c2mupdate command" class="screenshot" style="width: 80%; height: 80%" />
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                On the Overview page click on the down arrow next to <b>Reboot</b> in the upper right and then click <b>Shutdown</b>
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\shutdown.png" alt="c2mupdate command" class="screenshot" style="width: 80%; height: 80%" />
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                Choose <b>No Delay</b> and click <b>Shut down</b>
                                <br><br>
                                <ul>
                                    <li style="list-style-type: none;">
                                        <img src="images\shutdown2.png" alt="c2mupdate command" class="screenshot" style="width: 80%; height: 80%" />
                                    </li>
                                </ul>
                                <br><br>
                                Wait a minute or two and then you can safely unplug the Raspberry Pi.
                                <p>
                                You are now ready to install the Rasperry Pi in your coach. 
                            </li>
                    </li>
                </ol>
                <br>
                <h3>Installing the hardware in your coach</h3>

                You will need:
                <ul>
                    <li>Raspberry Pi</li>
                    <li>Four conductor RV-C cable with 3M mini plug installed on one end</li>
                </ul>
                <br>
                    Lithium Renogy Models will also need:
                    <ul>
                        <li>Two conductor wire with debug connector attached on one end</li>
                        <li>USB cable to connect to Inverter</li>
                    </ul>
                    <br>
                Inside your coach the Raspberry Pi will connect to the RV-C network for power and communication. If you have a Lithium model the Pi will also connect to the Renogy battery debug port and the Renogy Inverter with either a USB cable or an RS-485 connector.
                <p>
                Find a suitable location for the raspbery pi where your cables will reach all devices you need to connect to. In my Entegra Ethos 20D I mounted it under the rear bed near the Renogy Debug port and RV-C G4 Terminator tap.
                <p>
                <ol>
                    <li>Attach the 3m connector to one end of your RV-C wire. There is a good explanation on how to do this on <a href="https://myervin.com/working-with-3m-mini-clamp-connectors">myervin.com</a>
                        <br><br>
                        If you are connecting to the the 4 pin molex connector on the G12 you'll need to attach your wire to the connector. This is the pinout on the G12
                        <ul>
                            <li>
                                <img src="images/g12ports.png">
                            </li>
                        </ul>
                    </li>
                    <br><br>
                    <li> 
                Connect the RV-C cable blue and white wires to the Can0 terminal on the Canhat+. If you used official RV-C cable the blue wire will go to the terminal labled <bold>L</bold>, and white to <bold>H</bold>.
                </li>
                <p>
                <li>Connect the red RV-C wire to the <bold>+</bold> terminal, and the black RV-C wire to the <bold>-</bold> terminal.
                </li>
                <p>
                <li>If you have a Renogy Li model also connect the wires from the debug connector to Can1. You should connect the wire from the debug port that is labled Can_L to <bold>L</bold>, and Can_H to <bold>H</bold>.
                </li>
                <br><br>
                <ul>
                    <li style="list-style-type: none;">
                        <img src="images\canhat4.jpg" alt="canhat connected to canbus and rv-c" class="screenshot" style="width: 80%; height: 80%" />
                    </lyyi>
                <br>Using ferrules on the wires is optional but can make a more secure connection<br>
                </ul>

                <p>
                Plug the RV-C cable into either your Firefly G12 or G4 Terminal block.
                <ul>
                    <li style="list-style-type: none;">
                        <img src="images\g12.jpg" alt="canhat connected to canbus and rv-c" class="screenshot" style="width: 50%; height: 50%" />
                        <img src="images\g4.jpg" alt="canhat connected to canbus and rv-c" class="screenshot" style="width: 50%; height: 50%" />
                    </li>
                </ul>
                <p>For lithium models you also need to connect to the battery debug port and the Renogy inverter USB port:
                <p>
                <li>Plug in the debug connector to the Renogy Debug port
                </li>
                <br><br>
                <ul>
                    <li style="list-style-type: none;">
                        <img src="images\debugcon.jpg" alt="canhat connected to canbus and rv-c" class="screenshot" style="width: 80%; height: 80%" />
                    </li>
                </ul>
                Plug the USB cable into the Raspberry Pi and Renogy Inverter
                <ul>
                    <li style="list-style-type: none;">
                        <img src="images\inverter.png" alt="Renogy inverter" class="screenshot" style="width: 80%; height: 80%" />
                    </li>
                </ul>
                If you are using an RS-485 adapter you will need to make a cable to plug into the RS485/CAN port and connect to your RS-485 adapter. Pinout of the plug can be found on page 17 of the <a href="https://www.renogy.com/content/RIV4835CSH1S/RIV4835CSH1S-Manual.pdf">Renogy Inverter manual</a>. Only 2 wires are needed (Pin 2 and 3).<br><br>
                <ul>
                    <li style="list-style-type: none;">
                        <img src="images\rs485plug.png" alt="Renogy inverter RS-485 pinout" class="screenshot" style="width: 80%; height: 80%" />
                    </li>
                </ul>
                </ol>

                <p>Once the Raspberry Pi is connected to the RV-C network it will be powered any time your 12v switch is on. To prevent possible file corruption to the sd card you should always shutdown the Pi from the web interface before powering off the 12v switch.
                <p>
                Installation of the hardware in your van is complete and once powered up the Pi will begin communicating with the RV-C network, and optionally, the Renogy inverter and Renogy Lithium battery BMS.

                <p id="installingapp"><br></p>

                <h2>Installing the app</h2>

                <br>
                <h3>Install the app on your phone or tablet</h3>

                <p>
                In order to control the devices in your van you will need an App that can communicate with the MQTT broker that is running on the Rasperry Pi. There are many apps that are able to do this, but the app I found that is the most configurabale and available on both iOS and Android is <a href="https://blog.snrlab.in/iot/iot-mqtt-panel-user-guide/">IoT MQTT Panel</a>
                <ul>
                    <li>Apple App Store  : <a href="https://apps.apple.com/us/app/iot-mqtt-panel/id6466780124">IoT MQTT Panel</a></li>
                    <li>Google Play Store: <a href="https://play.google.com/store/apps/details?id=snr.lab.iotmqttpanel.prod&hl=en-US">IoT MQTT Panel</a></li>
                </ul>
                <p>
                After installing the app you will need to configure the dashboards and widgets. To make it easier I have included configuration files that can be loaded.
                <p>
                <ol>
                    <li>Connect your phone or tablet to the same WiFi the rasperry pi is connected to and navigate to <a href="http://coach2mqtt:1880/configs/">http://coach2mqtt:1880/configs/</a> - <i>Replace coach2mqtt with the hostname you set when creating the image. You may need to add .local to the name you configured. i.e. coach2mqtt.local</i>.
                         <ul>
                             <li style="list-style-type: none;">
                                 <img src="images\configs_page.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                             </li>
                         </ul>
                    </li>
                    <br>
                    <li>
                        Download the configuration file that matches your floorplan to your phone or tablet by clicking on the link.
                    </li>
                    <br>
                    <li>
                        Open the IoT MQTT Panel app on your phone or tablet
                        <ol>
                            <li>
                                Click on the <em>Hamburger Menu button</em> in the top left<br>
                                <img src="images\iot1.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                Click <em>Backup and Restore</em><br>
                                <img src="images\iot2.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                Click <em>Restore</em> and select the configuration file you downloaded earlier<br>
                                <img src="images\iot3.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                Click <em>YES</em> to generate a random client-id<br>
                                <img src="images\iot4.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                Click the <b>⋮</b> icon next to the <em>&lt;Floorplan&gt; Phone Release</em> connection<br>
                                <img src="images\iot5.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                Click the <b>🖉</b> icon to edit the connection<br>
                                <img src="images\iot6.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                Edit the <em>Broker address</em> to match the name you gave your Raspberry Pi<br><em>i.e. coach2mqtt or coach2mqtt.local</em><br> <em>Network protocol</em> should be <em>TCP</em> and <em>Port</em> should be <em>1883</em>.
                                <img src="images\iot8.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                If you are on the same wifi as the Raspberry Pi and your connection settings are connect you should see the connection status icon change to a cloud with a checkmark. Click on the connected configuration to open the Dashboards view<br>
                                <img src="images\iot9.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                            <li>
                                Touch the tab on the bottom to bring up each dashboard.<br>
                                <img src="images\iot-dashboard1.png" alt="Home dashboard" class="screenshot" style="width: 40%; height: 40%" />
                                <img src="images\iot-dashboard2.png" alt="Firefly dashboard" class="screenshot" style="width: 40%; height: 40%" />
                                <br>
                                <img src="images\iot-dashboard3.png" alt="Samkoon dashboard" class="screenshot" style="width: 40%; height: 40%" />
                                <img src="images\iot-dashboard4.png" alt="APS-500 dashboard" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                            </li>
                        </ol>
                    </li>
                    <p>
                    At this point you are set up for local access. You can now control and monitor your connected devices in the van from the <em>IoT MQTT Panel</em> app as long as you are connected to the same WiFi network as the Raspberry Pi - i.e. your Winegard or Starlink

                    <p id="remoteaccesssetup"><br></p>

                    <h2>Remote Access Setup</h2>
                    <p>Remote access can be set up in a variety of ways. I have found <a href="https://tailscale.com">Tailscale</a> to be the easiet option, but you can also set up a remote MQTT broker such as <a href="https://www.hivemq.com">HiveMQ</a>. Both options will allow you to remotely control your coach devices from the IoT MQTT Panel app on your phone. Tailscale will also let you remotely access your Raspberry Pi. Both options, of course, require that both your phone and the Raspberry Pi have internet access.

                    <h4>HiveMQ</h4>
                    <p>If you want to use <a href="https://www.hivemq.com">HiveMQ</a> for remote access you need to create a free account, create a cluster, configure access to HiveMQ, configure coach2mqtt to send and recieve data from coach2mqtt and then add the HiveMQ broker to the IoT MQTT Panel app as a new connection.
                    <ol>
                        <li>
                            Create a free account at <a href="https://www.hivemq.com">HiveMQ.com</a>
                        </li>
                        Once you have created your free account you will need to create a new cluster which will be where data is sent from your Raspberry Pi.

                        <li>
                            Click <b>Create New Cluster</b>
                            <ul>
                                <li style="list-style-type: none;">
                            <img src="images\hivemq\create-cluster-1.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul>
                        </li>
                        <li>
                            Choose the FREE Serverless option by clicking <b>Create Serverless Cluster</b>
                            <ul>
                                <li style="list-style-type: none;">
                            <img src="images\hivemq\create-cluster-2.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul>
                        </li>
                        <li>
                            Click <b>Manage Cluster</b> 
                        </li>
                        <li>
                            In the <b>Overview</b> tab copy the <b>TLS MQTT URL</b>.<br><em>We will be using the later when setting up remote access</em>

                            <ul>
                                <li style="list-style-type: none;">
                            <img src="images\hivemq\overview.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul>

                        </li>
                        <li>
                            Click the <b>Access Management</b> tab and then under <b>🔒 Authentication</b> click <b>Edit</b>
                            <ul>
                                <li style="list-style-type: none;">
                            <img src="images\hivemq\access-management-1.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul> and then <b>Add Credentials</b>.
                            <ul>
                                <li style="list-style-type: none;">
                            <img src="images\hivemq\access-management-2.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul>
                            <br><br>Enter a Name (i.e. <em>coach2mqtt</em>), choose <b>Publish and Subscribe</b> Permission. Next create a secure password and click <b>Save</b>.<br><em>We will use this username and password later when configuring the Raspberry Pi</em>
                            <ul>
                                <li style="list-style-type: none;">
                            <img src="images\hivemq\access-management-3.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul>
                            <br><br>Repeat to create a second user (i.e <em>panel-app</em>) for the IoT Panel App.<br><em>Be sure to save the username and password</em>
                            <ul>
                                <li style="list-style-type: none;">
                            <img src="images\hivemq\access-management-4.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul>
                        </li>
                    </ol>
                    <br>
                    <h4>Configure your Raspberry Pi to relay messages to HiveMQ</h4>
                    <p><em>The next steps must be performed on the same network as the Raspberry Pi</em>
                    <ol>
                        <li>
                            Open a browser and navigate to <a href="https://coach2mqtt:9090/system/terminal">https://coach2mqtt:9090/system/terminal</a> and log in - <i>Replace coach2mqtt with the hostname you set when creating the image</i>. <b>Depending on your network you may need to add <i>.local</i> to the hostname (i.e. coach2mqtt.local) in order to connect.</b>
                        </li>
                        <li>
                            In the terminal area type <b>sethivemq</b> and press &lt;enter&gt;<br> 
                            Type or paste the TLS MQTT URL from HiveMQ and hit &lt;enter&gt;.<br>Type or paste the username and hit &lt;enter&gt;.<br>Type or paste the password and hit &lt;enter&gt;.
                            <ul>
                                <li style="list-style-type: none;">
                                <img src="images\hivemq\sethivemq.png" alt="" class="screenshot" style="width: 70%; height: 70%" />
                                </li>
                            </ul>
                        </li>
                        Your credentials will be added to the MQTT broker running on the Raspberry Pi and Mosquitto will be restarted. All MQTT topics will now also be published to HiveMQ.
                        <p>If you need to modify the credentials or something goes wrong during this process you will need to edit the Mosquitto config file manually. The file is located in <b>/opt/coach2mqtt/configs/mosquitto/mosquitto.conf</b> - The mosquitto container will need to be restarted after modifying the configuration.
                    </ol>
                    <h4>Set up your connection to HiveMQ in the Iot MQTT Panel app</h4>
                    <ol>
                        <li>
                            Open the IoT MQTT Panel App and click the top left hamburger menu button.
                        </li>
                        <li>
                            Click <b>All Connections</b>
                        </li>
                        <li>
                            Click the <b>⋮</b> icon next to the HiveMQ connection and click The 🖉  to edit the connection<br>
                            <img src="images\iot5.png" alt="Configs page" class="screenshot" style="width: 40%; height: 40%" />
                                <br><br>
                        </li>
                        <li>
                            Enter your hivemq Broker address<br>
                            Make sure Port is 8883 and Network protocol is TCP-SSL
                            Expand <b>Additional options</b> and enter your panel-app username and password you set earlier and click <b>SAVE</b>
                        </li>
                    </ol>



                    <p>Alternatively you can set up Tailscale. This will use less bandwidth, but could interfere with any other VPN configured on your phone or tablet</p>
                    <ol>
                        <li>
                            Create a free account at <a href="https://tailscale.com">Tailscale.com</a>
                        </li>
                        <li>
                            Install tailscale on your Raspberry Pi
                        </li>
                        <li>
                            Install tailscale on your Phone or Tablet
                        </li>
                        <li>
                            Configure your devices so they are on the same Tailscale network
                        </li>
                    </ol>
                    
                    <p id="basicfeatures"><br></p>

            <div class="divider" style="width:24%; margin:30px 0;"></div>


                <h1>Basic Features</h1>

                <h2>Feature 1</h2>

                <p id="basicfeatures">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                </p>
                
                <h2>Feature 2</h2>
                
                <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br><br>
                <b>Explanation 1</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                <br>
                <br>
                <b>Explanation 2</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                <br>
                <br>
                <b>Explanation 3</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                <br>
                <br id="feature3">
                <b>Explanation 4</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                </p>
                
                <h2>Feature 3</h2>
                
                <p>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br id="feature4">
             Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                </p>
                
                <h2>Feature 4</h2>
                
                <p>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                  <br>
                  <br>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                 <br>
                 <br id="feature5">
                 Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                </p>
                
                
                <h2>Feature 5</h2>
                
                <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. 
                <br>
                <br>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br>
                </p>
                
        
                
               <h2>Feature 5</h2>
                 
               <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. 
                <br id="advanced">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                </p>
                
                <div class="divider" style="width:24%; margin:30px 0;"></div>
                
                <h1>Advanced Features</h1>
                
                <h2>Feature A</h2>
                
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor 
                in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. 
                <br>
                <br id="featureb">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                   
                
                <h2>Feature B</h2>
                
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                <br>
                <br id="featurec">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                
                
                <h2>Feature C</h2>
                  
                <p id="featurec1">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                  
                 
                <h2>Feature C.1</h2>

                <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit:
                </p>
                
                   <ul>
                    <li>
                    <b>Point 1</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    <br>
                    <li>
                    <b>Point 2</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor.
                    </li>
                    <br id="featurec2">
                     <li>
                    <b>Point 3</b> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                    <br>
                </ul>
                   
                 <h2>Feauture C.2</h2>
                   
                 <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    <br>
                    <br>
                     <b>Important:</b> Please notice that lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    <br>
                    <br>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                 </p>
                  
                  
                  <h2>Feature D</h2>
                  
                  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                  
                  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                  <br>
                  <br id="accesibility">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                  
                  
                <div class="divider" style="width:24%; margin:30px 0;"></div>

                <h1>More Info</h1>

                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.marks are protected by intellectual property rights.</p>

                <div class="doublespace"></div>
                <div class="divider" style="width:24%; margin:30px 0;"></div>
                

            </div>

        </div>


    </div>


</body>

</html>
